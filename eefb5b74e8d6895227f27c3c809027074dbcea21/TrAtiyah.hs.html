
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- common.css -->
      <style>* {-webkit-tap-highlight-color: rgba(0,0,0,0);}html {-webkit-text-size-adjust: none;}body {font-family: -apple-system, Helvetica, Arial, sans-serif;margin: 0;padding: 20px;color: #333;word-wrap: break-word;}h1, h2, h3, h4, h5, h6 {line-height: 1.1;}img {max-width: 100% !important;height: auto;}blockquote {margin: 0;padding: 0 15px;color: #777;border-left: 4px solid #ddd;}hr {background-color: #ddd;border: 0;height: 1px;margin: 15px 0;}code {font-family: Menlo, Consolas, 'Ubuntu Mono', Monaco, 'source-code-pro', monospace;line-height: 1.4;margin: 0;padding: 0.2em 0;font-size: 90%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}pre > code {margin: 0;padding: 0;font-size: 100%;word-break: normal;background: transparent;border: 0;}ol {list-style-type: decimal;}ol ol, ul ol {list-style-type: lower-latin;}ol ol ol, ul ol ol, ul ul ol, ol ul ol {list-style-type: lower-roman;}table {border-spacing: 0;border-collapse: collapse;margin-top: 0;margin-bottom: 16px;}table th {font-weight: bold;}table th, table td {padding: 6px 13px;border: 1px solid #ddd;}table tr {border-top: 1px solid #ccc;}table tr:nth-child(even) {background-color: #f8f8f8;}input[type="checkbox"] {cursor: default;margin-right: 0.5em;font-size: 13px;}.task-list-item {list-style-type: none;}.task-list-item+.task-list-item {margin-top: 3px;}.task-list-item input {float: left;margin: 0.3em 1em 0.25em -1.6em;vertical-align: middle;}#tag-field {margin: 8px 2px 10px;}#tag-field .tag {display: inline-block;background: #cadff3;border-radius: 4px;padding: 1px 8px;color: black;font-size: 12px;margin-right: 10px;line-height: 1.4;}</style>
      <!-- ace-static.css -->
      <style>.ace_static_highlight {white-space: pre-wrap;}.ace_static_highlight .ace_gutter {width: 2em;text-align: right;padding: 0 3px 0 0;margin-right: 3px;}.ace_static_highlight.ace_show_gutter > .ace_line {padding-left: 2.6em;}.ace_static_highlight .ace_line {position: relative;}.ace_static_highlight .ace_gutter-cell {-moz-user-select: -moz-none;-khtml-user-select: none;-webkit-user-select: none;user-select: none;top: 0;bottom: 0;left: 0;position: absolute;}.ace_static_highlight .ace_gutter-cell:before {content: counter(ace_line, decimal);counter-increment: ace_line;}.ace_static_highlight {counter-reset: ace_line;}</style>
      <style>.ace-solarized-light .ace_gutter {background: #fbf1d3;color: #333}.ace-solarized-light .ace_print-margin {width: 1px;background: #e8e8e8}.ace-solarized-light {background-color: #FDF6E3;color: #586E75}.ace-solarized-light .ace_cursor {color: #000000}.ace-solarized-light .ace_marker-layer .ace_selection {background: rgba(7, 54, 67, 0.09)}.ace-solarized-light.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px #FDF6E3;}.ace-solarized-light .ace_marker-layer .ace_step {background: rgb(255, 255, 0)}.ace-solarized-light .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgba(147, 161, 161, 0.50)}.ace-solarized-light .ace_marker-layer .ace_active-line {background: #EEE8D5}.ace-solarized-light .ace_gutter-active-line {background-color : #EDE5C1}.ace-solarized-light .ace_marker-layer .ace_selected-word {border: 1px solid #073642}.ace-solarized-light .ace_invisible {color: rgba(147, 161, 161, 0.50)}.ace-solarized-light .ace_keyword,.ace-solarized-light .ace_meta,.ace-solarized-light .ace_support.ace_class,.ace-solarized-light .ace_support.ace_type {color: #859900}.ace-solarized-light .ace_constant.ace_character,.ace-solarized-light .ace_constant.ace_other {color: #CB4B16}.ace-solarized-light .ace_constant.ace_language {color: #B58900}.ace-solarized-light .ace_constant.ace_numeric {color: #D33682}.ace-solarized-light .ace_fold {background-color: #268BD2;border-color: #586E75}.ace-solarized-light .ace_entity.ace_name.ace_function,.ace-solarized-light .ace_entity.ace_name.ace_tag,.ace-solarized-light .ace_support.ace_function,.ace-solarized-light .ace_variable,.ace-solarized-light .ace_variable.ace_language {color: #268BD2}.ace-solarized-light .ace_storage {color: #073642}.ace-solarized-light .ace_string {color: #2AA198}.ace-solarized-light .ace_string.ace_regexp {color: #D30102}.ace-solarized-light .ace_comment,.ace-solarized-light .ace_entity.ace_other.ace_attribute-name {color: #93A1A1}.ace-solarized-light .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWNgYGBgYHjy8NJ/AAjgA5fzQUmBAAAAAElFTkSuQmCC) right repeat-y}</style>
      <!-- export.css -->
      <style>
        body{margin:0 auto;max-width:800px;line-height:1.4}
        #nav{margin:5px 0 10px;font-size:15px}
        #titlearea{border-bottom:1px solid #ccc;font-size:17px;padding:10px 0;}
        #contentarea{font-size:15px;margin:16px 0}
        .cell{outline:0;min-height:20px;margin:5px 0;padding:5px 0;}
        .code-cell{font-family:Menlo,Consolas,'Ubuntu Mono',Monaco,'source-code-pro',monospace;font-size:12px;}
        .latex-cell{white-space:pre-wrap;}
      </style>
      <!-- User CSS -->
      <style> .text-cell {font-size: 15px;}.code-cell {font-size: 12px;}.markdown-cell {font-size: 15px;}.latex-cell {font-size: 15px;}</style>
    </head>
    <body>
      <div id="nav"><div>Next: <a href='Green’s example (and more generality).html'>Green’s example (and more generality)</a>, Previous: <a href='References.html'>References</a>, Up: <a href='index.html'>Index</a></div></div>
      <div id="titlearea">
        <h2>TrAtiyah.hs</h2>
      </div>
      <div id="contentarea"><div class="cell markdown-cell"><p><strong>please never share this code... it is code that only a mother could love</strong></p>
</div><div class="cell code-cell"><div class="ace-solarized-light"><div class="ace_static_highlight ace_show_gutter" style="counter-reset:ace_line 0"><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">module</span><span class="ace_meta ace_declaration ace_module ace_haskell"> </span><span class="ace_support ace_other ace_module ace_haskell">TrAtiyah</span><span class="ace_meta ace_declaration ace_module ace_haskell"> </span><span class="ace_keyword ace_other ace_haskell">where</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">import</span><span class="ace_meta ace_import ace_haskell"> </span><span class="ace_support ace_other ace_module ace_haskell">Data.Ratio</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">import</span><span class="ace_meta ace_import ace_haskell"> </span><span class="ace_support ace_other ace_module ace_haskell">Data.List</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">import</span><span class="ace_meta ace_import ace_haskell"> </span><span class="ace_support ace_other ace_module ace_haskell">Data.Ord</span><span class="ace_meta ace_import ace_haskell">      </span><span class="ace_meta ace_declaration ace_exports ace_haskell">(</span><span class="ace_entity ace_name ace_function ace_haskell">comparing</span><span class="ace_meta ace_declaration ace_exports ace_haskell">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_meta ace_import ace_haskell">import </span><span class="ace_support ace_other ace_module ace_haskell">Data.Tuple</span><span class="ace_meta ace_import ace_haskell">    </span><span class="ace_meta ace_declaration ace_exports ace_haskell">(</span><span class="ace_entity ace_name ace_function ace_haskell">fst</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span><span class="ace_meta ace_declaration ace_exports ace_haskell"> </span><span class="ace_entity ace_name ace_function ace_haskell">snd</span><span class="ace_meta ace_declaration ace_exports ace_haskell">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_meta ace_import ace_haskell">import </span><span class="ace_support ace_other ace_module ace_haskell">Data.Function</span><span class="ace_meta ace_import ace_haskell"> </span><span class="ace_meta ace_declaration ace_exports ace_haskell">(</span><span class="ace_entity ace_name ace_function ace_haskell">on</span><span class="ace_meta ace_declaration ace_exports ace_haskell">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_meta ace_import ace_haskell">import </span><span class="ace_support ace_other ace_module ace_haskell">Data.Char</span><span class="ace_meta ace_import ace_haskell">     </span><span class="ace_meta ace_declaration ace_exports ace_haskell">(</span><span class="ace_entity ace_name ace_function ace_haskell">digitToInt</span><span class="ace_meta ace_declaration ace_exports ace_haskell">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_meta ace_import ace_haskell">import </span><span class="ace_support ace_other ace_module ace_haskell">Data.Maybe</span><span class="ace_meta ace_import ace_haskell">    </span><span class="ace_meta ace_declaration ace_exports ace_haskell">(</span><span class="ace_entity ace_name ace_function ace_haskell">fromJust</span><span class="ace_meta ace_declaration ace_exports ace_haskell">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">import</span><span class="ace_meta ace_import ace_haskell"> </span><span class="ace_support ace_other ace_module ace_haskell">Math.LinearEquationSolver</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- this comes from the linearEqSolver package on hackage</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- we also use the CVC4 solver</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">import</span><span class="ace_meta ace_import ace_haskell"> </span><span class="ace_support ace_other ace_module ace_haskell">System.IO.Unsafe</span><span class="ace_meta ace_import ace_haskell"> </span><span class="ace_meta ace_declaration ace_exports ace_haskell">(</span><span class="ace_entity ace_name ace_function ace_haskell">unsafePerformIO</span><span class="ace_meta ace_declaration ace_exports ace_haskell">)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">type</span> <span class="ace_constant ace_other ace_haskell">AMonomial</span>   <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_constant ace_other ace_haskell">Rational</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> [<span class="ace_constant ace_other ace_haskell">Int</span>])
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- e.g. (1%2, [1,1,3,3]) corresponds to 1/2 * A_1^2 * A_3^2</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">type</span> <span class="ace_constant ace_other ace_haskell">APolynomial</span> <span class="ace_keyword ace_operator ace_haskell">=</span> [<span class="ace_constant ace_other ace_haskell">AMonomial</span>]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- a list of monomials corresponds to their sum</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">type</span> <span class="ace_constant ace_other ace_haskell">BMonomial</span>   <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_constant ace_other ace_haskell">Rational</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> [(<span class="ace_constant ace_other ace_haskell">Int</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_constant ace_other ace_haskell">Int</span>)])
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- e.g. (1%2, [(0,1),(1,2)]) corresponds to 1/2 * (A_1-A_0) * (A_2-A_1)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- n.b. B_{m,n} = A_n - A_m</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">type</span> <span class="ace_constant ace_other ace_haskell">BPolynomial</span> <span class="ace_keyword ace_operator ace_haskell">=</span> [<span class="ace_constant ace_other ace_haskell">BMonomial</span>]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- a list of monomials corresponds to their sum</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_keyword ace_other ace_haskell">type</span> <span class="ace_constant ace_other ace_haskell">FullVector</span> <span class="ace_keyword ace_operator ace_haskell">=</span> [(<span class="ace_constant ace_other ace_haskell">Rational</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_constant ace_other ace_haskell">String</span>)]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">aa</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>aa m <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> [m])
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">bb</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BMonomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>bb m n <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> [(m<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> n)])
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">trAtiyah</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BPolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>trAtiyah n <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">zip</span> [<span class="ace_constant ace_numeric ace_haskell">0</span><span class="ace_keyword ace_operator ace_haskell">..</span>n<span class="ace_keyword ace_operator ace_haskell">-</span><span class="ace_constant ace_numeric ace_haskell">1</span>] [<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_keyword ace_operator ace_haskell">..</span>n]) <span class="ace_keyword ace_operator ace_haskell">:</span> <span class="ace_constant ace_language ace_empty-list ace_haskell">[]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">convertBMtoAP</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>convertBMtoAP bm <span class="ace_keyword ace_operator ace_haskell">=</span> [ ((<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> am) * (<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> bm)<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> am) <span class="ace_keyword ace_operator ace_haskell">|</span> am<span class="ace_keyword ace_operator ace_haskell">&lt;-</span>productWithoutCoeff] 
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> productWithoutCoeff <span class="ace_keyword ace_operator ace_haskell">=</span> simplifyAP
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">foldr1</span> multiply2AP
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> simplifyAP
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword ace_operator ace_haskell">$</span> [ [aa n<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> minusA <span class="ace_keyword ace_operator ace_haskell">$</span> aa m] <span class="ace_keyword ace_operator ace_haskell">|</span> (m<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>n)<span class="ace_keyword ace_operator ace_haskell">&lt;-</span>(<span class="ace_support ace_function ace_prelude ace_haskell">snd</span> bm) ]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">minusA</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>minusA m <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_support ace_function ace_prelude ace_haskell">negate</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span> m<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> m)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">minusB</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BMonomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>minusB m <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_support ace_function ace_prelude ace_haskell">negate</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span> m<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> m)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">allCyclicPermutations</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_variable ace_other ace_generic-type ace_haskell">a</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">] </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [(</span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">, [</span><span class="ace_variable ace_other ace_generic-type ace_haskell">a</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">])]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>allCyclicPermutations xl <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">take</span> (<span class="ace_support ace_function ace_prelude ace_haskell">length</span> xl) <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">zip</span> [<span class="ace_constant ace_numeric ace_haskell">0</span><span class="ace_keyword ace_operator ace_haskell">..</span>]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>   <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">iterate</span> (<span class="ace_keyword ace_operator ace_haskell">\</span>(x<span class="ace_keyword ace_operator ace_haskell">:</span>xs) <span class="ace_keyword ace_operator ace_haskell">-&gt;</span> xs <span class="ace_keyword ace_operator ace_haskell">++</span> [x]) xl
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">lowestCyclicPermutation</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_meta ace_class-constraint ace_haskell">(</span><span class="ace_entity ace_other ace_inherited-class ace_haskell">Ord</span><span class="ace_meta ace_class-constraint ace_haskell"> </span><span class="ace_variable ace_other ace_generic-type ace_haskell">a</span><span class="ace_meta ace_class-constraint ace_haskell">) </span><span class="ace_keyword ace_other ace_big-arrow ace_haskell">=&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_variable ace_other ace_generic-type ace_haskell">a</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">] </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> (</span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">, [</span><span class="ace_variable ace_other ace_generic-type ace_haskell">a</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>lowestCyclicPermutation m <span class="ace_keyword ace_operator ace_haskell">=</span> minimumBy (comparing <span class="ace_support ace_function ace_prelude ace_haskell">snd</span>) <span class="ace_keyword ace_operator ace_haskell">$</span> allCyclicPermutations m
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">simplifyPermutationAM</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>simplifyPermutationAM m <span class="ace_keyword ace_operator ace_haskell">=</span> (newcoef<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> newmon)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> coefmod <span class="ace_keyword ace_operator ace_haskell">=</span> (*) (<span class="ace_entity ace_name ace_function ace_infix ace_haskell">(+)</span> <span class="ace_constant ace_numeric ace_haskell">1</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">length</span> <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> <span class="ace_keyword ace_operator ace_haskell">$</span> m)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    (<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> <span class="ace_keyword ace_operator ace_haskell">.</span> lowestCyclicPermutation <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> <span class="ace_keyword ace_operator ace_haskell">$</span> m)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  newcoef <span class="ace_keyword ace_operator ace_haskell">=</span> (*) ((<span class="ace_keyword ace_operator ace_haskell">-</span><span class="ace_constant ace_numeric ace_haskell">1</span>)^coefmod) <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span> m
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  newmon  <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> <span class="ace_keyword ace_operator ace_haskell">.</span> lowestCyclicPermutation <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> <span class="ace_keyword ace_operator ace_haskell">$</span> m
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">simplifyAdditionAP</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>simplifyAdditionAP <span class="ace_keyword ace_operator ace_haskell">=</span> dropZeros <span class="ace_keyword ace_operator ace_haskell">.</span> addMonomials
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> addMonomials ap <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_keyword ace_operator ace_haskell">\</span>l <span class="ace_keyword ace_operator ace_haskell">-&gt;</span> (<span class="ace_support ace_function ace_prelude ace_haskell">foldr1</span> <span class="ace_entity ace_name ace_function ace_infix ace_haskell">(+)</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span> l<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> <span class="ace_keyword ace_operator ace_haskell">$</span> l<span class="ace_keyword ace_operator ace_haskell">!!</span><span class="ace_constant ace_numeric ace_haskell">0</span>))
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword ace_operator ace_haskell">$</span> groupBy (<span class="ace_entity ace_name ace_function ace_infix ace_haskell">(==)</span> <span class="ace_punctuation ace_definition ace_entity ace_haskell">`</span><span class="ace_keyword ace_operator ace_function ace_infix ace_haskell">on</span><span class="ace_punctuation ace_definition ace_entity ace_haskell">`</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span>) <span class="ace_keyword ace_operator ace_haskell">.</span> sortBy (comparing <span class="ace_support ace_function ace_prelude ace_haskell">snd</span>)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword ace_operator ace_haskell">$</span> ap
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  dropZeros ap    <span class="ace_keyword ace_operator ace_haskell">=</span> [m <span class="ace_keyword ace_operator ace_haskell">|</span> m <span class="ace_keyword ace_operator ace_haskell">&lt;-</span> ap<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> (<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> m)<span class="ace_keyword ace_operator ace_haskell">/=</span><span class="ace_constant ace_numeric ace_haskell">0</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_support ace_function ace_prelude ace_haskell">not</span> <span class="ace_keyword ace_operator ace_haskell">.</span> zeroTrace <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> m<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_support ace_function ace_prelude ace_haskell">not</span> <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">elem</span> <span class="ace_constant ace_numeric ace_haskell">0</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> m]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  zeroTrace m
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_keyword ace_operator ace_haskell">|</span> <span class="ace_support ace_function ace_prelude ace_haskell">odd</span> <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">length</span> <span class="ace_keyword ace_operator ace_haskell">$</span> m                   <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_constant ace_haskell">False</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_keyword ace_operator ace_haskell">|</span> intersect evenPerms oddPerms <span class="ace_keyword ace_operator ace_haskell">/=</span> <span class="ace_constant ace_language ace_empty-list ace_haskell">[]</span> <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_constant ace_haskell">True</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_keyword ace_operator ace_haskell">|</span> <span class="ace_support ace_function ace_prelude ace_haskell">otherwise</span>                          <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_constant ace_haskell">False</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_keyword ace_other ace_haskell">where</span> oddPerms  <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">filter</span> (<span class="ace_support ace_function ace_prelude ace_haskell">odd</span> <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span>) <span class="ace_keyword ace_operator ace_haskell">$</span> allPerms
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    evenPerms <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">filter</span> (<span class="ace_support ace_function ace_prelude ace_haskell">even</span> <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span>) <span class="ace_keyword ace_operator ace_haskell">$</span> allPerms
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    allPerms  <span class="ace_keyword ace_operator ace_haskell">=</span> allCyclicPermutations m
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">simplifyAP</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>simplifyAP <span class="ace_keyword ace_operator ace_haskell">=</span> simplifyAdditionAP <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> simplifyPermutationAM
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">simplifyBP</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BPolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BPolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>simplifyBP bp <span class="ace_keyword ace_operator ace_haskell">=</span> [bm <span class="ace_keyword ace_operator ace_haskell">|</span> bm<span class="ace_keyword ace_operator ace_haskell">&lt;-</span>bp<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> (<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> bm)<span class="ace_keyword ace_operator ace_haskell">/=</span><span class="ace_constant ace_numeric ace_haskell">0</span>]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">multiply2AM</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>multiply2AM m m' <span class="ace_keyword ace_operator ace_haskell">=</span> ((<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> m)*(<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> m')<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">concat</span> [<span class="ace_support ace_function ace_prelude ace_haskell">snd</span> m<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> m'])
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">multiply2AP</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>multiply2AP p p' <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_support ace_function ace_prelude ace_haskell">foldr1</span> multiply2AM)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_support ace_function ace_prelude ace_haskell">zipWith</span> (<span class="ace_keyword ace_operator ace_haskell">\</span>l n <span class="ace_keyword ace_operator ace_haskell">-&gt;</span> l<span class="ace_keyword ace_operator ace_haskell">!!</span>n) [p<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>p']) allCombos
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> simplep   <span class="ace_keyword ace_operator ace_haskell">=</span> simplifyAdditionAP p
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  simplep'  <span class="ace_keyword ace_operator ace_haskell">=</span> simplifyAdditionAP p'
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  allCombos <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">sequence</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_keyword ace_operator ace_haskell">\</span>x<span class="ace_keyword ace_operator ace_haskell">-&gt;</span>[<span class="ace_constant ace_numeric ace_haskell">0</span><span class="ace_keyword ace_operator ace_haskell">..</span>x<span class="ace_keyword ace_operator ace_haskell">-</span><span class="ace_constant ace_numeric ace_haskell">1</span>]) <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">length</span> [p<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>p']
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">mDeRhamD</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">AMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>mDeRhamD am <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">zip</span> altSignCoeffs leibnitzList
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> altSignCoeffs <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (* (<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> am)) <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> ((^) (<span class="ace_keyword ace_operator ace_haskell">-</span><span class="ace_constant ace_numeric ace_haskell">1</span>)) [<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_keyword ace_operator ace_haskell">..</span>]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  leibnitzList  <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">zipWith</span> <span class="ace_entity ace_name ace_function ace_infix ace_haskell">(++)</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  (<span class="ace_support ace_function ace_prelude ace_haskell">tail</span> <span class="ace_keyword ace_operator ace_haskell">.</span> inits <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> am)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  (<span class="ace_support ace_function ace_prelude ace_haskell">init</span> <span class="ace_keyword ace_operator ace_haskell">.</span> tails <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> am)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">deRhamD</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>deRhamD ap <span class="ace_keyword ace_operator ace_haskell">=</span> simplify <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">concat</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> mDeRhamD ap
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> simplify <span class="ace_keyword ace_operator ace_haskell">=</span> simplifyAP
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">mCechD</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>mCechD k bm <span class="ace_keyword ace_operator ace_haskell">=</span> simplifyAP <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">concat</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>   <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> convertBMtoAP
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">zipWith</span> <span class="ace_entity ace_name ace_function ace_infix ace_haskell">($)</span> (<span class="ace_support ace_function ace_prelude ace_haskell">cycle</span> [<span class="ace_support ace_function ace_prelude ace_haskell">id</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> minusB])
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">zip</span> (<span class="ace_support ace_function ace_prelude ace_haskell">repeat</span> <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span> <span class="ace_keyword ace_operator ace_haskell">$</span> bm) cechList
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> cechList <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_keyword ace_operator ace_haskell">\</span>vs <span class="ace_keyword ace_operator ace_haskell">-&gt;</span> [ (vs<span class="ace_keyword ace_operator ace_haskell">!!</span>x<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> vs<span class="ace_keyword ace_operator ace_haskell">!!</span>y) <span class="ace_keyword ace_operator ace_haskell">|</span> (x<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>y)<span class="ace_keyword ace_operator ace_haskell">&lt;-</span>(<span class="ace_support ace_function ace_prelude ace_haskell">snd</span> bm) ])
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">zipWith</span> <span class="ace_entity ace_name ace_function ace_infix ace_haskell">(++)</span> (inits [<span class="ace_constant ace_numeric ace_haskell">0</span><span class="ace_keyword ace_operator ace_haskell">..</span>(k<span class="ace_keyword ace_operator ace_haskell">+</span><span class="ace_constant ace_numeric ace_haskell">1</span>)]) (<span class="ace_support ace_function ace_prelude ace_haskell">tail</span> <span class="ace_keyword ace_operator ace_haskell">$</span> tails [<span class="ace_constant ace_numeric ace_haskell">0</span><span class="ace_keyword ace_operator ace_haskell">..</span>(k<span class="ace_keyword ace_operator ace_haskell">+</span><span class="ace_constant ace_numeric ace_haskell">1</span>)])
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- here the degree k is the number of variables, since a Cech k-cycle</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- is given by (k+1) elements, but all of our A_j are \omega_{i,j}, and so we</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- only need k variables to get a Cech k-cycle</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">uniqueMonomialsAsNumbers</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_support ace_type ace_prelude ace_haskell">String</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>uniqueMonomialsAsNumbers k d <span class="ace_keyword ace_operator ace_haskell">=</span> nub <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_support ace_function ace_prelude ace_haskell">snd</span>) <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> lowestCyclicPermutation
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">mapM</span> (<span class="ace_support ace_function ace_prelude ace_haskell">const</span> stringOfVariables) [<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_keyword ace_operator ace_haskell">..</span>d]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span>    <span class="ace_keyword ace_other ace_haskell">where</span> stringOfVariables <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">concat</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_support ace_function ace_prelude ace_haskell">show</span>) [<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_keyword ace_operator ace_haskell">..</span>k]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">numberStringToBM</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">String</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BMonomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>numberStringToBM xs <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> turnDigitIntoPolynomial xs)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> turnDigitIntoPolynomial x
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword ace_operator ace_haskell">|</span> x<span class="ace_keyword ace_operator ace_haskell">==</span><span class="ace_punctuation ace_definition ace_string ace_begin ace_haskell">'</span><span class="ace_string ace_quoted ace_single ace_haskell">1</span><span class="ace_punctuation ace_definition ace_string ace_end ace_haskell">'</span>    <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_constant ace_numeric ace_haskell">0</span><span class="ace_keyword ace_operator ace_haskell">::</span><span class="ace_constant ace_other ace_haskell">Int</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span><span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_keyword ace_operator ace_haskell">::</span><span class="ace_constant ace_other ace_haskell">Int</span>)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>    <span class="ace_keyword ace_operator ace_haskell">|</span> <span class="ace_support ace_function ace_prelude ace_haskell">otherwise</span> <span class="ace_keyword ace_operator ace_haskell">=</span> (<span class="ace_constant ace_numeric ace_haskell">1</span><span class="ace_keyword ace_operator ace_haskell">::</span><span class="ace_constant ace_other ace_haskell">Int</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>digitToInt x)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">uniqueMonomialsAsBM</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_storage ace_type ace_haskell">BMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>uniqueMonomialsAsBM k d <span class="ace_keyword ace_operator ace_haskell">=</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_support ace_function ace_prelude ace_haskell">map</span> numberStringToBM <span class="ace_keyword ace_operator ace_haskell">$</span> uniqueMonomialsAsNumbers k d
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">convertAPtoFV</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">APolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">FullVector</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>convertAPtoFV k d p <span class="ace_keyword ace_operator ace_haskell">=</span> sortBy (comparing <span class="ace_support ace_function ace_prelude ace_haskell">snd</span>) unsortedVector
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> basis <span class="ace_keyword ace_operator ace_haskell">=</span> uniqueMonomialsAsNumbers k d
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  pAsString <span class="ace_keyword ace_operator ace_haskell">=</span> [(c<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">concat</span> <span class="ace_keyword ace_operator ace_haskell">.</span> (<span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">show</span>) <span class="ace_keyword ace_operator ace_haskell">$</span> m) <span class="ace_keyword ace_operator ace_haskell">|</span> (c<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>m)<span class="ace_keyword ace_operator ace_haskell">&lt;-</span>p]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  missing <span class="ace_keyword ace_operator ace_haskell">=</span> basis <span class="ace_keyword ace_operator ace_haskell">\\</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> pAsString
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  missingWithCoefficients <span class="ace_keyword ace_operator ace_haskell">=</span> [(<span class="ace_constant ace_numeric ace_haskell">0</span><span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>m) <span class="ace_keyword ace_operator ace_haskell">|</span> m<span class="ace_keyword ace_operator ace_haskell">&lt;-</span>missing]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  unsortedVector <span class="ace_keyword ace_operator ace_haskell">=</span> pAsString <span class="ace_keyword ace_operator ace_haskell">++</span> missingWithCoefficients
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- here k and d are the same as in mCechD</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">toAugmentedMatrix</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_storage ace_type ace_haskell">FullVector</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">] </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">FullVector</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> ([[</span><span class="ace_storage ace_type ace_haskell">Rational</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">]], [</span><span class="ace_storage ace_type ace_haskell">Rational</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">])</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>toAugmentedMatrix c r <span class="ace_keyword ace_operator ace_haskell">=</span> (coeffs<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> result)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> coeffs <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">toRational</span>) <span class="ace_keyword ace_operator ace_haskell">$</span> transpose <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span>) c
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  result <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">toRational</span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> <span class="ace_support ace_function ace_prelude ace_haskell">fst</span> r
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">solveAugmentedMatrix</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> ([[</span><span class="ace_storage ace_type ace_haskell">Rational</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">]], [</span><span class="ace_storage ace_type ace_haskell">Rational</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">]) </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_storage ace_type ace_haskell">Rational</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>solveAugmentedMatrix am <span class="ace_keyword ace_operator ace_haskell">=</span> unsafePerformIO <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">fmap</span> fromJust
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  <span class="ace_keyword ace_operator ace_haskell">$</span> solveRationalLinearEqs <span class="ace_constant ace_other ace_haskell">CVC4</span> (<span class="ace_support ace_function ace_prelude ace_haskell">fst</span> am) (<span class="ace_support ace_function ace_prelude ace_haskell">snd</span> am)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">resubSolOnPreimage</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_storage ace_type ace_haskell">BMonomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">] </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_storage ace_type ace_haskell">Rational</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">] </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BPolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>resubSolOnPreimage bl rl <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> scale <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">zip</span> bl rl
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> scale <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_keyword ace_operator ace_haskell">\</span>(m<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>r)<span class="ace_keyword ace_operator ace_haskell">-&gt;</span>(r * <span class="ace_support ace_function ace_prelude ace_haskell">fst</span> m<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span> <span class="ace_support ace_function ace_prelude ace_haskell">snd</span> m)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- We want to call this with k = d = p for the p-th atiyah class,</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_punctuation ace_definition ace_comment ace_haskell">-- and then call this with k = k-1, d=d+1 for the result of the above, etc.</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">deRhamInverseCechBP</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BPolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_storage ace_type ace_haskell">BPolynomial</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>deRhamInverseCechBP k d bp <span class="ace_keyword ace_operator ace_haskell">=</span> simplifyBP
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span> <span class="ace_keyword ace_operator ace_haskell">$</span> resubSolOnPreimage uniqueMons <span class="ace_keyword ace_operator ace_haskell">$</span> solution
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> uniqueMons <span class="ace_keyword ace_operator ace_haskell">=</span> uniqueMonomialsAsBM (k<span class="ace_keyword ace_operator ace_haskell">-</span><span class="ace_constant ace_numeric ace_haskell">1</span>) (d<span class="ace_keyword ace_operator ace_haskell">+</span><span class="ace_constant ace_numeric ace_haskell">1</span>)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  solution   <span class="ace_keyword ace_operator ace_haskell">=</span> solveAugmentedMatrix mat
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  mat        <span class="ace_keyword ace_operator ace_haskell">=</span> toAugmentedMatrix vl dp
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  vl         <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (convertAPtoFV k (d<span class="ace_keyword ace_operator ace_haskell">+</span><span class="ace_constant ace_numeric ace_haskell">1</span>))
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>   <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (mCechD (k<span class="ace_keyword ace_operator ace_haskell">-</span><span class="ace_constant ace_numeric ace_haskell">1</span>)) uniqueMons
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>  dp         <span class="ace_keyword ace_operator ace_haskell">=</span> convertAPtoFV k (d<span class="ace_keyword ace_operator ace_haskell">+</span><span class="ace_constant ace_numeric ace_haskell">1</span>)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>   <span class="ace_keyword ace_operator ace_haskell">$</span> deRhamD <span class="ace_keyword ace_operator ace_haskell">.</span> simplifyAP <span class="ace_keyword ace_operator ace_haskell">.</span> <span class="ace_support ace_function ace_prelude ace_haskell">concat</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span>   <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> convertBMtoAP bp
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_entity ace_name ace_function ace_haskell">computeRepresentative</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_double-colon ace_haskell">::</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_support ace_type ace_prelude ace_haskell">Int</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> </span><span class="ace_keyword ace_other ace_arrow ace_haskell">-&gt;</span><span class="ace_meta ace_function ace_type-declaration ace_haskell"> [</span><span class="ace_storage ace_type ace_haskell">BPolynomial</span><span class="ace_meta ace_function ace_type-declaration ace_haskell">]</span>
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>computeRepresentative p <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">scanl</span> (<span class="ace_support ace_function ace_prelude ace_haskell">flip</span> <span class="ace_entity ace_name ace_function ace_infix ace_haskell">($)</span>) (trAtiyah p) list
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>    <span class="ace_keyword ace_other ace_haskell">where</span> list <span class="ace_keyword ace_operator ace_haskell">=</span> <span class="ace_support ace_function ace_prelude ace_haskell">map</span> (<span class="ace_support ace_function ace_prelude ace_haskell">uncurry</span> deRhamInverseCechBP)
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span><span class="ace_indent-guide">    </span> <span class="ace_keyword ace_operator ace_haskell">$</span> <span class="ace_support ace_function ace_prelude ace_haskell">zip</span> [p<span class="ace_punctuation ace_separator ace_comma ace_haskell">,</span>(p<span class="ace_keyword ace_operator ace_haskell">-</span><span class="ace_constant ace_numeric ace_haskell">1</span>)<span class="ace_keyword ace_operator ace_haskell">..</span><span class="ace_constant ace_numeric ace_haskell">2</span>] [p<span class="ace_keyword ace_operator ace_haskell">..</span>(<span class="ace_constant ace_numeric ace_haskell">2</span>*p<span class="ace_keyword ace_operator ace_haskell">-</span><span class="ace_constant ace_numeric ace_haskell">2</span>)]
</div><div class="ace_line"><span class="ace_gutter ace_gutter-cell" unselectable="on"></span>
</div></div></div></div><div class="cell markdown-cell"><p><img src="resources/55DAEE23BA151905779E547A11B0C576.jpg" alt="IMAGE" width="2090" height="678"></p>
</div></div>
      <script>document.body.onkeyup = function(e) {
if (e.keyCode === 39) window.location.href = 'Green’s example (and more generality).html';
if (e.keyCode === 37) window.location.href = 'References.html';
}</script>
    </body>
    </html>
  